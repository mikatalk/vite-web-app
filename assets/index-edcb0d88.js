var A=Object.defineProperty;var C=(n,e,t)=>e in n?A(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var g=(n,e,t)=>(C(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(o){if(o.ep)return;o.ep=!0;const s=t(o);fetch(o.href,s)}})();const R="modulepreload",T=function(n){return"/"+n},S={},I=function(e,t,a){if(!t||t.length===0)return e();const o=document.getElementsByTagName("link");return Promise.all(t.map(s=>{if(s=T(s),s in S)return;S[s]=!0;const i=s.endsWith(".css"),f=i?'[rel="stylesheet"]':"";if(!!a)for(let u=o.length-1;u>=0;u--){const p=o[u];if(p.href===s&&(!i||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${f}`))return;const c=document.createElement("link");if(c.rel=i?"stylesheet":R,i||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),i)return new Promise((u,p)=>{c.addEventListener("load",u),c.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e())};function x(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:a,onRegistered:o,onRegisteredSW:s,onRegisterError:i}=n;let f,w;const c=async(p=!0)=>{await w};async function u(){if("serviceWorker"in navigator){const{Workbox:p}=await I(()=>import("./workbox-window.prod.es5-a7b12eab.js"),[]);f=new p("/sw.js",{scope:"/",type:"classic"}),f.addEventListener("activated",d=>{(d.isUpdate||d.isExternal)&&window.location.reload()}),f.addEventListener("installed",d=>{d.isUpdate||a==null||a()}),f.register({immediate:e}).then(d=>{s?s("/sw.js",d):o==null||o(d)}).catch(d=>{i==null||i(d)})}}return w=u(),c}console.log("Initializing PWA...");"serviceWorker"in navigator&&!/localhost/.test(window.location)&&x();let y;const m=document.querySelector("#main-install-app-button");window.addEventListener("beforeinstallprompt",n=>{n.preventDefault(),y=n,m.style.display="block",m.addEventListener("click",()=>{m.style.display="none",y.prompt(),y.userChoice.then(e=>{e.outcome==="accepted"?console.log("User accepted the A2HS prompt"):console.log("User dismissed the A2HS prompt"),y=null})})});(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0)&&(m.style.display="none");const B=()=>{var n;return!!((n=window.matchMedia)!=null&&n.call(window,"(display-mode: standalone)").matches||window.navigator.standalone)};B()&&(m.style.display="none");window.addEventListener("appinstalled",n=>{console.log("success app install!")});const b=class{constructor(e,t,a=b.UNSET){this.x=e,this.y=t,this.value=a}};let h=b;g(h,"UNSET","unset"),g(h,"SET","set");class M{constructor(){g(this,"cells",Array.from({length:100}).map((e,t)=>new h(t%10,Math.floor(t/10))))}getCellValueAtIndex(e){return this.cells[e].value}setCellValueAtIndex(e,t){this.cells[e].value=t}getCellValueAtPoint(e,t){return this.getCellValueAtIndex(this.pointToIndex(e,t))}setCellValueAtPoint(e,t,a){this.setCellValueAtIndex(this.pointToIndex(e,t),a)}pointToIndex(e,t){return e+10*t}}const v=class{constructor(e=null){e&&(this.points=v.PIECES.find(t=>t.type===e)),this.points=this.getRandomPiece()}getRandomPiece(){return JSON.parse(JSON.stringify(v.PIECES[Math.floor(v.PIECES.length*Math.random())]))}};let E=v;g(E,"PIECES",[{type:"BigL",rotationAble:!0,points:[[0,0],[1,0],[2,0],[2,1],[2,2]]},{type:"SmallL",rotationAble:!0,points:[[0,0],[1,0],[1,1]]},{type:"Dot",rotationAble:!1,points:[[0,0]]},{type:"SmallSquare",rotationAble:!1,points:[[0,0],[1,0],[0,1],[1,1]]},{type:"BigSquare",rotationAble:!1,points:[[0,0],[1,0],[2,0],[0,1],[1,1],[2,1],[0,2],[1,2],[2,2]]},{type:"Line2",rotationAble:!0,points:[[0,0],[1,0]]},{type:"Line3",rotationAble:!0,points:[[0,0],[1,0],[2,0]]},{type:"Line4",rotationAble:!0,points:[[0,0],[1,0],[2,0],[3,0]]},{type:"Line5",rotationAble:!0,points:[[0,0],[1,0],[2,0],[3,0],[4,0]]}]);const l={bankPieces:[],grid:new M,changes:{grid:{previous:0,value:1},bank:{previous:0,value:1}}},r={state:l,mutate:{doSomething(){l.grid.setCellValueAtPoint(Math.floor(Math.random()*10),Math.floor(Math.random()*10),h[Math.random()>.5?"SET":"UNSET"]),l.changes.grid.value+=1},addPieceToBank(){l.bankPieces.push(new E),l.changes.bank.value+=1},hasRendered(n){l.changes[n].previous=l.changes[n].value}},getters:{gridChanged:()=>l.changes.grid.previous!==l.changes.grid.value,bankChanged:()=>l.changes.bank.previous!==l.changes.bank.value}};console.log("store:",r);console.log("cells:",r.state.grid.cells);const O=document.querySelector("#app .grid"),L=[];r.state.grid.cells.forEach(({value:n})=>{const e=document.createElement("div");e.classList.add("box"),n==="set"&&e.classList.add("active"),L.push(e),O.appendChild(e)});const P=document.querySelector("#app .footer .bank");r.mutate.addPieceToBank();r.mutate.addPieceToBank();r.mutate.addPieceToBank();k();function k(){window.requestAnimationFrame(k),r.getters.gridChanged()&&N(),r.getters.bankChanged()&&U()}function N(){console.log("redraw grid"),r.state.grid.cells.forEach(({value:n},e)=>{const t=L[e];n==="set"?t.classList.add("active"):t.classList.remove("active")}),r.mutate.hasRendered("grid")}function U(){console.log("redraw bank"),P.innerHTML="",r.state.bankPieces.forEach((n,e)=>{const t=document.createElement("div");t.classList.add("piece"),P.appendChild(t)}),r.mutate.hasRendered("bank")}
